<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Register</title>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/all.min.css">
  <link rel="stylesheet" href="../css/bootstrap.min.css">
  <script src="../js/jquery-3.6.0.min.js"></script>
</head>
<body>
  <header class="bg-light text-center py-4">
    <img id="logo" src="../images/logo.png" alt="Glow & Grow" height="80">
    <h1>Register</h1>
  </header>

  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">G&G</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
          <li class="nav-item"><a class="nav-link" href="products.html">Products</a></li>
          <li class="nav-item"><a class="nav-link" href="gallery.html">Gallery</a></li>
          <li class="nav-item"><a class="nav-link" href="contact.html">Contact Us</a></li>
          <li class="nav-item"><a class="nav-link" href="login.html" id="loginBtn">Login</a></li>
          <li class="nav-item"><a class="nav-link active" href="register.html" id="registerBtn">Register</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <section class="container mt-4">
    <div class="row justify-content-center">
    <div class="col-md-6 col-lg-5">
      <div class="card shadow-sm border-0">
        <div class="card-body p-4">
          <h2 class="h4 mb-3 text-center">Create your account</h2>

          <form id="registerForm" novalidate>
            <!-- Email -->
            <div class="mb-3">
              <label for="email" class="form-label">Email address</label>
              <input
                type="email"
                class="form-control"
                id="email"
                name="email"
                placeholder="you@example.com"
                required
                pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[A-Za-z]{2,63}$"
                title="Please enter a valid email (e.g., name@example.com)."
              />
              <div class="invalid-feedback">Please enter a valid email address (e.g., name@example.com).</div>
            </div>

            <!-- Password -->
            <div class="mb-3">
              <label for="password" class="form-label">Password</label>
              <div class="input-group">
                <input
                  type="password"
                  class="form-control"
                  id="password"
                  name="password"
                  placeholder="At least 6 characters"
                  minlength="6"
                  required
                />
                <button class="btn btn-outline-secondary" type="button" data-toggle-target="password" aria-label="Show password">Show</button>
              </div>
              <div class="invalid-feedback">Password must be at least 6 characters long.</div>
            </div>

            <!-- Confirm Password -->
            <div class="mb-4">
              <label for="confirmPassword" class="form-label">Confirm password</label>
              <div class="input-group">
                <input
                  type="password"
                  class="form-control"
                  id="confirmPassword"
                  name="confirmPassword"
                  placeholder="Re-enter your password"
                  required
                />
                <button class="btn btn-outline-secondary" type="button" data-toggle-target="confirmPassword" aria-label="Show password">Show</button>
              </div>
              <div class="invalid-feedback">Passwords do not match.</div>
            </div>

            <button type="submit" class="btn btn-primary w-100">Register</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast (self-contained in section) -->
  <div class="position-fixed bottom-0 end-0 p-3" style="z-index:1080">
    <div id="toastMsg" class="toast align-items-center text-bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div id="toastBody" class="toast-body">Registration successful!</div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>
  </div>

  <script>
    (function () {
      const form = document.getElementById('registerForm');
      const email = document.getElementById('email');
      const password = document.getElementById('password');
      const confirmPassword = document.getElementById('confirmPassword');

      // Strict email pattern (requires TLD like .com, .net, etc.)
      const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[A-Za-z]{2,63}$/;

      function setValidity(input, isValid) {
        input.classList.toggle('is-invalid', !isValid);
        input.classList.toggle('is-valid', isValid);
      }

      function validateEmail() {
        const value = email.value.trim();
        const ok = emailPattern.test(value);
        if (!ok) {
          email.setCustomValidity('Invalid email');
        } else {
          email.setCustomValidity('');
        }
        setValidity(email, ok);
        return ok;
      }

      function validatePassword() {
        const ok = password.value.trim().length >= 6;
        setValidity(password, ok);
        return ok;
      }

      function validateConfirm() {
        const ok = confirmPassword.value === password.value && confirmPassword.value !== '';
        setValidity(confirmPassword, ok);
        return ok;
      }

      // Show/Hide password toggles
      document.querySelectorAll('[data-toggle-target]').forEach(btn => {
        btn.addEventListener('click', () => {
          const targetId = btn.getAttribute('data-toggle-target');
          const input = document.getElementById(targetId);
          if (!input) return;
          const isPassword = input.type === 'password';
          input.type = isPassword ? 'text' : 'password';
          btn.textContent = isPassword ? 'Hide' : 'Show';
          btn.setAttribute('aria-label', isPassword ? 'Hide password' : 'Show password');
        });
      });

      // Live validation
      email.addEventListener('input', validateEmail);
      password.addEventListener('input', () => {
        validatePassword();
        validateConfirm();
      });
      confirmPassword.addEventListener('input', validateConfirm);

      form.addEventListener('submit', function (e) {
        e.preventDefault();

        const okEmail = validateEmail();
        const okPass = validatePassword();
        const okConfirm = validateConfirm();

        if (okEmail && okPass && okConfirm) {
          // Toast then redirect
          try {
            const toastEl = document.getElementById('toastMsg');
            const toastBody = document.getElementById('toastBody');
            if (toastBody) toastBody.textContent = 'Registration successful!';
            if (window.bootstrap && toastEl) {
              const toast = new bootstrap.Toast(toastEl);
              toast.show();
              setTimeout(() => { window.location.href = 'index.html'; }, 1200);
            } else {
              // Fallback redirect
              window.location.href = 'index.html';
            }
          } catch {
            window.location.href = 'index.html';
          }
        } else {
          // Trigger browser tooltip messages if any invalid
          form.reportValidity && form.reportValidity();
        }
      });
    })();
  </script>
  </section>

  <footer class="bg-dark text-white text-center py-3">
    <p>&copy; 2025 Glow & Grow. All rights reserved.</p>
  </footer>

  <!-- Modals -->
  <div id="modalContainer"></div>

  <!-- Toast -->
  <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
    <div id="toastMsg" class="toast align-items-center text-bg-primary border-0" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body" id="toastBody">
          Welcome!
        </div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>
  </div>

  <script src="../js/main.js"></script>
  <script src="../js/bootstrap.bundle.min.js"></script>
</body>
</html>